<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hello WebGL</title>
  <!--
  Shader - Fits into beginning and end or render pipeline of WebGL
           When writing them, you are writing instructions to tell the GPU how to deal with each pixel on the screen
    
    Types:
      1. Vertex - config on how we control each vertex in application
      2. Fragment - config on how we control color output for each pixel 

    Model View Projection matrix transformation
      - Transform the vertex for a local world to a projection space
   -->
  <script id="shader-fs" type="x-shader/x-fragment">
    precision mediump float;

    void main(void) {
      gl_FragColor = vec4(0.9, 0.3, 0.6, 1.0);
    }
  </script>

  <script id="shader-vs" type="x-shader/x-vertex">
    attribute vec3 Position;
    uniform mat4 u_Modelview;
    uniform mat4 u_Persp;

    void main(void) {
      gl_Position = u_Persp * u_Modelview * vec4(Position, 1.0);
    }
  </script>
  <!-- 
  Buffers - stores the vertex positions and other info. This data is used when WebGL issues a request to draw
   -->

  <script>
    var gl, canvas, shader_prog, triangleVertexPositionBuffer;

    function initGL() {
      try {
        canvas = document.getElementById("webgl_hello_world");
        gl = canvas.getContext("webgl");
        gl.viewportWidth = canvas.width;
        gl.viewportHeight = canvas.height;
        console.log("WebGL Initialized");
      }catch (e) {}

      if(!gl) alert("WebGL is not available on your browser");
    }

    function initShaders() {
      var fragmentShader = getShader(gl, "shader-fs");
      var vertexShader = getShader(gl, "shader-vs");

      shader_prog = gl.createProgram();
      gl.attachShader(shader_prog, vertexShader);
      gl.attachShader(shader_prog, fragmentShader);
      gl.linkProgram(shader_prog);

      if(!gl.getProgramParameter(shader_prog, gl.LINK_STATUS)) {
        alert("Could not initialize shaders");
      }

      gl.useProgram(shader_prog);
      shader_prog.positionLocation = gl.getAttribLocation(shader_prog, "Position");
      gl.enableVertexAttribArray(shader_prog.positionLocation);

      shader_prog.u_PerspLocation = gl.getUniformLocation(shader_prog, "u_Persp");
      shader_prog.u_ModelviewLocation = gl.getUniformLocation(shader_prog, "u_Modelview");
    }

    function initBuffers() {
      triangleVertexPositionBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, triangleVertexPositionBuffer);
      var vertices = [
        0.0, 1.0, 0.0,
        -1.0, -1.0, 0.0,
        1.0, -1.0, 0.0
      ];

      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);
      triangleVertexPositionBuffer.itemSize = 3;
      triangleVertexPositionBuffer.numItems = 3;
    }
  </script>
</head>
<body onload="initGL()">
  <canvas id="webgl_hello_world" width=800 height=800></canvas>
</body>
</html>